<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Encuesta de Satisfacci√≥n</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      background-color: #6A0F20; /* GUINDA */
      position: relative;
      background-attachment: fixed;
    }

    /* ===== MARCA DE AGUA CON TU IMAGEN ===== */
    .container {
      max-width: 900px;
      margin: auto;
      background: rgba(255,255,255,0.93);
      padding: 20px;
      border-radius: 12px;
      backdrop-filter: blur(4px);
      position: relative; /* necesario */
      overflow: hidden; /* evita que el logo sobresalga */
    }

/* Marca de agua dentro del cuadro blanco */
    .container::before {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 70%;        /* tama√±o del logo */
      height: 70%;
      background-image: url("FID.jpg"); /* tu logo */
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
      opacity: 0.08;     /* transparencia */
      pointer-events: none; /* no bloquea clics */
      z-index: 0;
      }

/* Para que los textos queden arriba del logo */
    .container * {
      position: relative;
      z-index: 1;
    }


    /* Hace que el contenido est√© por encima del fondo */
    .page, .container {
      position: relative;
      z-index: 1;
    }

    /* ===== CONTENEDOR CON FONDO BLANCO TRASL√öCIDO ===== */
    .container { max-width: 900px; margin: auto; background: rgba(255,255,255,0.93); /* blanco 93% */ padding: 20px; border-radius: 12px; backdrop-filter: blur(4px); }

    h2 {
      text-align: center;
      font-size: 32px;   /* Ajusta el tama√±o aqu√≠ */
      font-weight: 700;  /* M√°s grueso */
      margin-bottom: 20px;
    }

    .label-row {
      display: flex;
      align-items: center;
      gap: 2px; /* Espacio entre texto y bocina */
    }

    .audio-btn {
      background: none;
      border: none;
      padding: 0;
      margin: 0;
      font-size: 26px;    /* tama√±o del √≠cono */
      cursor: pointer;
      line-height: 1;
      width: auto;        /* elimina ancho excesivo */
      height: auto;       /* elimina alto excesivo */
    }

    .audio-btn:hover {
      transform: scale(1.2);
    }

    .thanks-box {
      min-height: 450px;
      padding: 40px;
      background: rgba(255, 255, 255, 0.93);
      border-radius: 12px;
      backdrop-filter: blur(4px);
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }

    
    .page { display: none; padding: 20px; }

    .active { 
      display: block; 
    }

    .question { margin-bottom: 45px; }

    label { display: block; margin-bottom: 8px; font-weight: bold; font-size: 20px;}

    input[type="text"], textarea, select { width: 90%; padding: 12px; font-size: 18px; border-radius: 8px; border: 1px solid #ccc; display: block; margin: auto; }
    
    textarea { height: 100px; }
    .emoji-row { display: flex; gap: 100px; justify-content: center; }
    .emoji-container {display: flex; flex-direction: column; align-items: center;} 
    .emoji { font-size: 180px; cursor: pointer; opacity: 0.5; transition: 0.2s; }
    .emoji.selected { opacity: 1; transform: scale(1.2); }
    .emoji-text {margin-top: -10px; font-size: 22px; font-weight: 600; color: #333; text-align: center;}
    button {
      width: 100%; padding: 16px; font-size: 20px; border: none; border-radius: 10px; cursor: pointer; background: #007bff; color: white;
    }
    /* === FADE SUAVE DEL CARRUSEL === */
    #carousel-img {
      width: 100%;
      height: auto;
      border-radius: 12px;
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

  </style>
</head>
<body>
  <!-- PAGINA PRINCIPAL -->
  <div id="page-main" class="page active">
    <div class="container">
      <h2>Encuesta de Satisfacci√≥n</h2>

      <div class="question">
        <div class="label-row">
          <label>1. Nombre del paciente</label>
          <button class="audio-btn" data-audio="pregunta1.mp3">üîä</button>
        </div>
  
        <input id="nombre" type="text" />
      </div>


      <div class="question">
        <label>2. ¬øQu√© tan satisfecho est√°s con nuestro servicio?</label>
        <div class="emoji-row">
          <div class="emoji-container">
            <div class="emoji" data-value="malo">üôÅ</div>
            <div class="emoji-text">Muy insatisfecho</div>
          </div>
        
          <div class="emoji-container">
            <div class="emoji" data-value="medio">üòê</div>
            <div class="emoji-text">Neutral</div>
          </div>
        
        
          <div class="emoji-container">
            <div class="emoji" data-value="bueno">üòÉ</div>
            <div class="emoji-text">Muy satisfecho</div>
          </div>
        </div>
      </div>

      <div class="question">
        <label>3. Tipo de servicio</label>
        <select id="servicio">
          <option value="">Seleccione...</option>
          <option>Terapia de lenguaje</option>
          <option>Terapia acu√°tica</option>
          <option>Terapia motriz</option>
        </select>
      </div>

      <div class="question">
        <label>4. Colaborador</label>
        <select id="colaborador">
          <option value="">Seleccione...</option>
          <option>Juan</option>
          <option>Marisol</option>
          <option>Esteban</option>
        </select>
      </div>

      <div class="question">
        <label>5. Observaciones, opiniones o felicitaciones</label>
        <textarea id="observaciones"></textarea>
      </div>

      <button id="btnEnviar">Enviar</button>
    </div>
  </div>

  <!-- PAGINA DE AGRADECIMIENTO -->
  <div id="page-thanks" class="page">
    <div class="container thanks-box">
      <h2>¬°Gracias por tus comentarios!</h2>
    </div>
  </div>

  <!-- PAGINA DE ESPERA -->
  <div id="page-wait" class="page">
    <div class="container">
      <h2>Toca la pantalla para ir al formulario</h2>
      <div class="carousel">
        <img id="carousel-img" src="" alt="imagen" />
      </div>
    </div>
  </div>

  <script>
    // ------------------------ VARIABLES ------------------------
    let selectedSatisfaction = null;
    const emojis = document.querySelectorAll('.emoji');
    const pages = {
      main: document.getElementById('page-main'),
      thanks: document.getElementById('page-thanks'),
      wait: document.getElementById('page-wait')
    };

    let inactivityTimer;

    // ------------------------ EMOJIS ------------------------
    emojis.forEach(e => {
      e.addEventListener('click', () => {
        emojis.forEach(x => x.classList.remove('selected'));
        e.classList.add('selected');
        selectedSatisfaction = e.dataset.value;
      });
    });

    // ------------------------ VALIDACI√ìN Y ENV√çO ------------------------
    document.getElementById('btnEnviar').addEventListener('click', () => {

  const nombre = document.getElementById('nombre').value.trim();
  const servicio = document.getElementById('servicio').value;
  const colaborador = document.getElementById('colaborador').value;
  const observaciones = document.getElementById('observaciones').value.trim();

  if (!nombre || !selectedSatisfaction || !servicio || !colaborador || !observaciones) {
    alert("Todos los campos son obligatorios.");
    return;
  }

  const data = new URLSearchParams();
  data.append("nombre", nombre);
  data.append("satisfaction", selectedSatisfaction); // "malo", "medio", "bueno"
  data.append("servicio", servicio);
  data.append("colaborador", colaborador);
  data.append("observaciones", observaciones);

  fetch("https://script.google.com/macros/s/AKfycbxHDCbFSpmv2f6aLd0FsGADDTqMLaigsIOnrGQQgnYLjUQDy58hbENMjBfpfMZXVeZO/exec", {
    method: 'POST',
    body: data
  })
  .then(r => r.text())
  .then(console.log)
  .catch(console.error);

  // LIMPIAR CAMPOS
  document.getElementById('nombre').value = "";
  document.getElementById('servicio').value = "";
  document.getElementById('colaborador').value = "";
  document.getElementById('observaciones').value = "";
  selectedSatisfaction = null;
  document.querySelectorAll('.emoji').forEach(e => e.classList.remove('selected'));

  showPage('thanks');
  setTimeout(() => showPage('main'), 10000);
});

    // ------------------------ PANTALLA DE ESPERA (CARRUSEL) ------------------------
    const images = [
      "carrusel1.JPG", "carrusel2.JPG", "carrusel3.JPG", "carrusel4.JPG", "carrusel5.JPG",
      "carrusel6.JPG", "carrusel7.JPG", "carrusel8.JPG", "carrusel9.JPG", "carrusel10.JPG"
    ];

    let idx = 0;
    setInterval(() => {
      if (pages.wait.classList.contains('active')) {
        const img = document.getElementById('carousel-img');
        img.style.opacity = 0;

        setTimeout(() => {
          img.src = images[idx];
          idx = (idx + 1) % images.length;
          img.style.opacity = 1;
        }, 1500); 
      }
    }, 6000);

    // ------------------------ >>> AQU√ç AGREGO LO QUE FALTABA <<< ------------------------

    // Cuando se toca/clic la pantalla de espera, regresar al formulario
    pages.wait.addEventListener("click", () => {
      if (pages.wait.classList.contains("active")) {
        showPage("main");
        resetInactivity();
      }
    });

    // ------------------------ INACTIVIDAD ------------------------
    function resetInactivity() {
      clearTimeout(inactivityTimer);
      inactivityTimer = setTimeout(() => showPage('wait'), 60000);
    }

    document.addEventListener('mousemove', resetInactivity);
    document.addEventListener('touchstart', resetInactivity);
    resetInactivity();

    // ------------------------ NAVEGACI√ìN ------------------------
    function showPage(p) {
      Object.values(pages).forEach(pg => pg.classList.remove('active'));
      pages[p].classList.add('active');
    }

    let currentAudio = null;

    document.querySelectorAll('.audio-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const audioSrc = btn.getAttribute('data-audio');

        if (currentAudio) currentAudio.pause();
        
        const audio = new Audio(audioSrc);
        audio.play();
      });
    });

    
</script>

</body>
</html>
